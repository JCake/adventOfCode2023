import re;
input1 = r'''.|...\....
|.-.\.....
.....|-...
........|.
..........
.........\
..../.\\..
.-.-/..|..
.|....-|.\
..//.|....''';
input2 = r'''\..............................................................-......-.............-........\-...............
./.........................-..-............................../..........|..|.-\..|.|.../.................-....
|......|...\./|....\............./-..........\|............./..../.....|....\.......................-....../..
.......-.....\.........\../............-.-.................|....-\.....\..\......|./..........................
................................./..-.................-\............/......|..../..|.....\|...................
.....|......../.....|...-.............../......\................................\........|.....\......./......
............\............|..........\......\...../......................|.........................\...........
...........................\.......-..|..../.............\........//.................../..-............|......
..................\......................./....-..../........./\.......|................./............/.\.....
.\......./..........\.......\./..--...|..............-..........\.\...../.../....../.-./........./....\.......
..../......./.........|...........................\....................|.............../|.../.../...\..\...../
...-.\|\.....-............................-........................\...............\....-..................../
........\....|.....-...-..|..\..-./..........|.............|..............................\...................
.....\......................................./...........-.........................-....................../...
....\...............................-...........\............\.........-|..-..|........../..-.....|.../......|
........\.......-./...-.../...................................-.......|........./............|.\..............
............\...........-.....\..|.......................|.......|.............\......./...........|..........
.|.....|...................-...|.................................../\....../..../..........|.............|./..
...............|......./......................../......................./.....-.............../.............\.
...\..-/.........-........................-............................/\.\.......-..|..............-.........
...-........./......\..\..............-............/.............-......-.........|................/........-.
............\..\...|.........|..................../\........../..\.....................\............../.......
........\.................................../..../..................|........-................................
...|.../............\-..-....\..|....|........-./.............................\...............................
......-.\.-......\......../.|..........\.|..../..\....................../..\/./...../--...................|...
.......\|............/...|...|.........../........../...........|........./...................................
\........\...........................-/.......................-............-..|......|..............\.........
......................../|............\.............../......|.-\..\.......|../...........-..............-....
.............................\.....-..............|...........|/...../.....-..................../.....-..-/.--
.|...........................-.........|....-/.-.....\.........../.........|......\..../.\.\...............|..
...................\.........................\...................|..../...........-..............-............
...............-.....-.......\.............|........../-.........../..........\.....|............|.../.....-..
..........|.-...................................-............|../.............................|../............
...|..........\.......\....\..........|........./.........-|-............|....................................
./\..../.......|........|....|......../............/............/................................|............
..........................\........................../........|.........................\\................-...
....../....|.../..\.-..|....././|-.....|........................................-.....................-.......
.\.-............./...|..../|........./|...........-\..|.................|.../......................./.........
.........|........../.........\.........../............../..............\....\..............-|................
....-...../...\...........................\.-......|........\...-...|..............|......|.\.....-...........
...-.............................-\.........-..../.\..........-..../......--............................\.....
.................-........|..................-.|................|....-....\...|....../....\...................
...\.........\..........|................/..........|....\./..................../-............./..............
/........\....-......-.-|...........|../........\.|.......|...........|.................-.............|.......
......../....../.......\...............\.......-....................../..................|.../.........\......
.\....../.........|...................................|-.|../.../...........-.-.............\................-
/-..\/.......-........\../.....-..|..................\................|......./...............................
......../.................-..../.................-...-|.........|............../...........|..................
..|......../.....\......................|.....|/...../.............-.|-...-...|......................-........
......|........|.\.........\............-........-/......./.............../......./......................|...\
....|...............\...../.............../......|......../............|/...|........./...../..........-.\.--.
..|.........|......|.............................|...........-....|...-.............../................/......
.....................|........./............./........................................../.........|...........
.....\........................|../.....................-.......|.-........................../../......-.......
..........................-....../.......\.............................-....\................/................
................................-...../.........//.........-...|../....\..................................-...
...........................-................|/|.||............................................\...\.....|.....
..|..........-................/...................-.......|..................................-...............\
../....-.........-...............................................\.....\...........|-............./.......|...
......\...|......../........................./...........................................|....................
.-..................../...-..|.-..\...../.........-............./..........\..................................
....-....-...........-........-........|......................\................................./\....-.......
..........|...................................\.../....../...-......|../............|......|................\.
.-.|.|.|.........-........-....\.........|......../..-.........../............\......-\.......|.......|.......
........|......../.............|...\.\......../...-........\.......\......-........-......./.../..............
..../..........-............/././.........|.-...........|.........../.........................\-....|.........
........\......................../................-................|..\........./...\.......\.\...............
.............\........|....\....../..........|..\................./...||......./|..\................\.....\...
./.|.................................../...|....................|...................|...../.\............../..
.../....................\..........|.-...............................\.........|....|\./.../.\.\..............
\|........./.\...-......\..............\..........|...........\.|\............/...........-...................
....................../..\...\..........................|-..........-\................\......./.-.............
................................/.....................|././......../............/.\...|.......................
.............................-./............|.............|.-.............../..........|.../................./
...............-........................//........././............/...../...-......-\\........................
-././.........../..-....|.......-......./..................-...........|......./......./....|.................
........../.............................\...-............|.............\..-........../......./.\.../.........\
..................|\..........................|..........|....................|...\...........\...............
.....-.....\../....|.|....|.|........|.-..-........................../.........................-........-.....
.....\......\............./..............-.....|........................................\......|...\........|.
..|......../..................................\..........-.............\..............\......|.....-..........
.\....................................|.|.././.-../-..............................|.|........\........./......
....................-.../.../...../......\....|........./........-../...................|..................-..
\...........|...\....-...-..\....................................-.|./..........................\.............
.........\..........\.................-...........-........-....-.-..................\.-........|.-....\......
..........................................|........|..........................\......\......\.-.|...\../...\..
..-..................\.\..-........................................\.........-..|...../......|................
.../....../......\./.\|.../.-........-............-../...........-.......-.........\.|................-.......
..|\..../.|........................|........-/.........-..|......|..........-.....|.......\.../..-......-.....
............................................................../.................\..|...-./............|...../.
..\.|.....-............-/\.............|.............\...............|....../........../....-/..\../......\...
............................/....-.../...................|.....-........|.../....\........-.....-...|...|.....
../..../.............|..\...||......-..-...................-...........\...-.....\.....|.........||..//.......
............................/.....\..\....-................/..../........\....\.................-|............
...-........-..../..........|.......-...|........|....-.......\...|....../...//...|...........\.......|-......
......./.........|../.........../...\............\................/..|..\.\.....................\...|.........
....-.............../.|.../............\..........--...........................|........./......|.............
............./.................\............/......-................/|.............\./........\..|....\.......
............\.............|..|.|\....-...-|/|...\...........................-....../.......|..................
./...../|...\........\|....-...............\\.........../........-../................................-........
-......-.\...|...\..|.|..../.........-...........|...................-.|..............-../............../.....
..|..........|/......................................\.........|............./.................-..|-..........
..\.......\................\...\....................\............................-......|......\....-.....-...
..||................................-...\.-.....|................./......|..............|.....\...............
..................-......../.....|..\.......--.../...../.\-.............-........................../.........\
-.......\............./............/...|...-.../...........\.................|.....\....\.\....-..../..-......
-............/.......\........................................................\..-.....................\......
.../................................................../.........../....|.........\.....................-......
...................|.......\......././................|..-......\....-.....-|...|.....-.......................
..........................-.......................-.....-......-............\.....\....\.-....................''';
grid = [list(row) for row in re.split('\n',input2)]
gridCopy = [list(row) for row in re.split('\n',input2)]
prevLightBeams = set([]);
lightBeams = set([((0,0),'R')]);
locIndex = 0;
dirIndex = 1;
spotsLit = set([(0,0)]);
def goDownFrom(nextLoc,newLightBeams):
    processLoc(nextLoc,'D',newLightBeams);
def goUpFrom(nextLoc,newLightBeams):
    processLoc(nextLoc,'U',newLightBeams)
def goRightFrom(nextLoc,newLightBeams):
    processLoc(nextLoc,'R',newLightBeams);
def goLeftFrom(nextLoc,newLightBeams):
    processLoc(nextLoc,'L',newLightBeams);
def processLoc(loc,direct,newLightBeams):
    if direct == 'R':
        if loc[1] + 1 < len(grid[0]):
            nextLoc = (loc[0],loc[1]+1)
            spotsLit.add(nextLoc);
            nextSquare = grid[nextLoc[0]][nextLoc[1]]
            if nextSquare == '.' or nextSquare == '-':
                newLightBeams.append((nextLoc,'R'))
            elif nextSquare == '|':
                goUpFrom(nextLoc,newLightBeams);
                goDownFrom(nextLoc,newLightBeams);
            elif nextSquare == '\\':
                goDownFrom(nextLoc,newLightBeams);
            elif nextSquare == '/':
                goUpFrom(nextLoc,newLightBeams);
    if direct == 'L':
        if loc[1] - 1 >= 0:
            nextLoc = (loc[0],loc[1]-1)
            spotsLit.add(nextLoc);
            nextSquare = grid[nextLoc[0]][nextLoc[1]]
            if nextSquare == '.' or nextSquare == '-':
                newLightBeams.append((nextLoc,'L'))
            elif nextSquare == '|':
                goUpFrom(nextLoc,newLightBeams);
                goDownFrom(nextLoc,newLightBeams);
            elif nextSquare == '\\':
                goUpFrom(nextLoc,newLightBeams);
            elif nextSquare == '/':
                goDownFrom(nextLoc,newLightBeams);
    if direct == 'U':
        if loc[0] - 1 >= 0:
            nextLoc = (loc[0]-1,loc[1])
            spotsLit.add(nextLoc);
            nextSquare = grid[nextLoc[0]][nextLoc[1]]
            if nextSquare == '.' or nextSquare == '|':
                newLightBeams.append((nextLoc,'U'))
            elif nextSquare == '-':
                goLeftFrom(nextLoc,newLightBeams);
                goRightFrom(nextLoc,newLightBeams);
            elif nextSquare == '\\':
                goLeftFrom(nextLoc,newLightBeams);
            elif nextSquare == '/':
                goRightFrom(nextLoc,newLightBeams);
    if direct == 'D':
        if loc[0] + 1 < len(grid):
            nextLoc = (loc[0]+1,loc[1])
            spotsLit.add(nextLoc);
            nextSquare = grid[nextLoc[0]][nextLoc[1]]
            if nextSquare == '.' or nextSquare == '|':
                newLightBeams.append((nextLoc,'D'))
            elif nextSquare == '-':
                goLeftFrom(nextLoc,newLightBeams);
                goRightFrom(nextLoc,newLightBeams);
            elif nextSquare == '\\':
                goRightFrom(nextLoc,newLightBeams);
            elif nextSquare == '/':
                goLeftFrom(nextLoc,newLightBeams);
# TODO need to figure out how to end...
while not prevLightBeams == lightBeams:
    newLightBeams = [];
    for beam in lightBeams:
        loc = beam[locIndex];
        direct = beam[dirIndex]
        processLoc(loc,direct,newLightBeams);
    prevLightBeams = lightBeams.copy();
    lightBeams = set(newLightBeams);
    print(len(prevLightBeams));
    print(len(lightBeams));
    print(lightBeams);
    for spot in spotsLit:
        gridCopy[spot[0]][spot[1]] = '#';
    for row in gridCopy:
        print(''.join(row));
    print('\n');
    print(len(spotsLit));
print(spotsLit);
print(len(spotsLit));
        
